/*
 * Copyright (c) 2023 Linaro Limited
 *
 * SPDX-License-Identifier: Apache-2.0
 */

#define MBEDTLS_TEST_NULL_ENTROPY

#define CONFIG_MBEDTLS_ALLOW_PRIVATE_ACCESS

#define MBEDTLS_X509_CSR_WRITE_C
#define MBEDTLS_X509_CREATE_C
#define MBEDTLS_PEM_WRITE_C
#define MBEDTLS_BASE64_C

#define MBEDTLS_CAN_ECDH
#define MBEDTLS_RSA_C
#define MBEDTLS_X509_CRT_PARSE_C
#define MBEDTLS_PKCS1_V15
#define MBEDTLS_PK_CAN_ECDSA_SIGN

#ifndef CONFIG_BUILD_WITH_TFM

    // fake modules for non-sec build
    #define MBEDTLS_PSA_CRYPTO_STORAGE_C
    #define MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG
    #define MBEDTLS_GENPRIME

#endif /* CONFIG_BUILD_WITH_TFM */

#define MBEDTLS_PSA_UTIL_HAVE_ECDSA
#define PSA_WANT_KEY_TYPE_ECC_PUBLIC_KEY 1
#define PSA_WANT_KEY_TYPE_RSA_PUBLIC_KEY 1
#define PSA_WANT_KEY_TYPE_RSA_KEY_PAIR_BASIC 1

// TODO: needed at least non-sec build but may not be needed in TF-M build
#define PSA_WANT_KEY_TYPE_RSA_KEY_PAIR_GENERATE 1
#define PSA_WANT_KEY_TYPE_ECC_KEY_PAIR_GENERATE 1
#define MBEDTLS_ECDSA_C
#define MBEDTLS_PSA_BUILTIN_ALG_RSA_PKCS1V15_SIGN

#define PSA_WANT_ALG_DETERMINISTIC_ECDSA
#define PSA_WANT_ALG_ECDH
//#define PSA_WANT_ALG_ECDSA
#define PSA_WANT_ALG_TLS12_PRF

#define PSA_WANT_KEY_TYPE_ECC_PUBLIC_KEY 1
#define PSA_WANT_KEY_TYPE_RSA_PUBLIC_KEY 1
#define PSA_WANT_KEY_TYPE_RSA_KEY_PAIR_BASIC 1

#define PSA_WANT_KEY_TYPE_ECC_PUBLIC_KEY 1
#define PSA_WANT_KEY_TYPE_RSA_PUBLIC_KEY 1
#define PSA_WANT_KEY_TYPE_RSA_KEY_PAIR_BASIC 1
